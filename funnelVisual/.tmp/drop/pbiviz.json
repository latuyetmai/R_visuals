{"visual":{"name":"funnelVisual","displayName":"funnelVisual","guid":"funnelVisual707C8B5B902E4671972B2C3CC511329F","visualClassName":"Visual","version":"1.0.0","description":"Funnel Visual","supportUrl":"https://app.powerbi.com","gitHubUrl":"https://github.com/latuyetmai/R_visuals"},"author":{"name":"Mai La","email":"mai.la@nov.com"},"apiVersion":"5.1.0","style":"style/visual.less","stringResources":{},"capabilities":{"dataRoles":[{"displayName":"dataset","kind":"GroupingOrMeasure","name":"dataset"}],"dataViewMappings":[{"scriptResult":{"dataInput":{"table":{"rows":{"select":[{"for":{"in":"dataset"}}],"dataReductionAlgorithm":{"top":{}}}}},"script":{"scriptProviderDefault":"R","scriptOutputType":"png","source":{"objectName":"rcv_script","propertyName":"source"},"provider":{"objectName":"rcv_script","propertyName":"provider"},"scriptSourceDefault":"#plot(Values);\r\n# Copyright (c) Microsoft Corporation.  All rights reserved.\r\n\r\n# Third Party Programs. This software enables you to obtain software applications from other sources. \r\n# Those applications are offered and distributed by third parties under their own license terms.\r\n# Microsoft is not developing, distributing or licensing those applications to you, but instead, \r\n# as a convenience, enables you to use this software to obtain those applications directly from \r\n# the application providers.\r\n# By using the software, you acknowledge and agree that you are obtaining the applications directly\r\n# from the third party providers and under separate license terms, and that it is your responsibility to locate, \r\n# understand and comply with those license terms.\r\n# Microsoft grants you no license rights for third-party software or applications that is obtained using this software.\r\n\r\n# See also:\r\n# http://stats.stackexchange.com/questions/5195/how-to-draw-funnel-plot-using-ggplot2-in-r/5210#5210\r\n\r\n#RVIZ_IN_PBI_GUIDE:BEGIN:Removed to enable R-visual in Power BI\r\n#dataset = read.csv(file = \"dataset.csv\", header = TRUE, sep = \",\", stringsAsFactors = FALSE)\r\n#RVIZ_IN_PBI_GUIDE:END:Removed to enable R-visual in Power BI\r\n\r\n\r\n###############Library Declarations###############\r\n\r\nlibraryRequireInstall = function(packageName, ...)\r\n{\r\n  if(!require(packageName, character.only = TRUE)) \r\n    warning(paste(\"*** The package: '\", packageName, \"' was not installed ***\", sep=\"\"))\r\n}\r\n\r\n\r\nlibraryRequireInstall(\"ggplot2\")\r\nlibraryRequireInstall(\"scales\")\r\n\r\n\r\n###############Internal parameters definitions#################\r\n# Set of parameters, which are not exported to GUI\r\n\r\n\r\n##PBI_PARAM Color of scatterplot points\r\n#Type:string, Default:\"orange\", Range:NA, PossibleValues:\"orange\",\"blue\",\"green\",\"black\"\r\npointsCol = \"orange\"\r\n\r\n#PBI_PARAM Transparency of scatterplot points\r\n#Type:numeric, Default:0.4, Range:[0,1], PossibleValues:NA, Remarks: NA\r\ntransparency = 0.4\r\n\r\n##PBI_PARAM Color of baseline\r\n#Type:string, Default:\"blue\", Range:NA, PossibleValues:\"orange\",\"blue\",\"green\",\"black\"\r\nlineColor = \"blue\"\r\n\r\n\r\n#PBI_PARAM Sparsification of scatterplot points\r\n#Type:bool, Default:TRUE, Range:NA, PossibleValues:NA, Remarks: NA\r\nsparsify = TRUE\r\n\r\n#PBI_PARAM Size of points on the plot\r\n#Type:numeric, Default: 1 , Range:[0.1,5], PossibleValues:NA, Remarks: NA\r\npointCex = 1\r\n\r\n\r\n#PBI_PARAM Confidence level line\r\n#Type:numeric, Default: 0.75 , Range:[0,1], PossibleValues:NA, Remarks: GUI input is predefined set of values\r\nconf1 = 0.95\r\n\r\n#PBI_PARAM Confidence level line #2\r\n#Type:numeric, Default: 0.95 , Range:[0,1], PossibleValues:NA, Remarks: NA\r\nconf2 = 0.99\r\n\r\n##PBI_PARAM Precentage or Ratio ?\r\n#Type:bool, Default:TRUE, Range:NA, PossibleValues:NA\r\naxisXisPercentage = TRUE # ratio or percentage\r\n\r\n##PBI_PARAM Axis X format\r\n#Type:string, Default:\"comma\", Range:NA, PossibleValues:\"none\",\"comma\",\"scientific\",\"dollar\"\r\nscaleXformat = \"comma\"\r\n\r\n##PBI_PARAM Axis Y format\r\n#Type:string, Default:\"none\", Range:NA, PossibleValues:\"none\",\"comma\",\"scientific\"\r\nscaleYformat = \"none\"\r\n\r\n#PBI_PARAM Size of labels on axes\r\nsizeLabel = 12\r\n\r\n#PBI_PARAM Size of ticks on axes\r\nsizeTicks = 6\r\n\r\n#PBI_PARAM Size of labels on axes\r\ncolLabel = \"gray\"\r\n\r\n#PBI_PARAM is vertical plot\r\nverticalPlot = FALSE\r\n\r\n#PBI_PARAM Minimal number of points for funnel plot\r\nminPoints = 10\r\n\r\n#PBI_PARAM Size of warnings font\r\nsizeWarn = 11\r\n\r\n\r\n###############Internal functions definitions#################\r\n# Functions, used only for this visual \r\n\r\n\r\n# Post-process text string to show on plot\r\n# if very very long abbreviate\r\n# if looooooong convert to lo...\r\n# if shorter than maxChar remove \r\ncutStr2Show = function(strText, strCex = 0.8, abbrTo = 100, isH = TRUE, maxChar = 3, partAvailable = 1)\r\n{\r\n  # partAvailable, wich portion of window is available, in [0,1]\r\n  if(is.null(strText))\r\n    return (NULL)\r\n  \r\n  SCL = 0.075*strCex/0.8\r\n  pardin = par()$din\r\n  gStand = partAvailable*(isH*pardin[1]+(1-isH)*pardin[2]) /SCL\r\n  \r\n  # if very very long abbreviate\r\n  if(nchar(strText)>abbrTo && nchar(strText)> 1)\r\n    strText = abbreviate(strText, abbrTo)\r\n  \r\n  # if looooooong convert to lo...\r\n  if(nchar(strText)>round(gStand) && nchar(strText)> 1)\r\n    strText = paste(substring(strText,1,floor(gStand)),\"...\",sep=\"\")\r\n  \r\n  # if shorter than maxChar remove \r\n  if(gStand<=maxChar)\r\n    strText = NULL\r\n  \r\n  return(strText) \r\n}\r\n\r\n\r\n#randomly remove points from scatter if too many \r\nSparsifyScatter = function (xyDataFrame, numXstrips = 9, numYstrips = 7, minMaxPoints = c(3000,9000), minmaxInStrip =  c(900,9000), maxInCell = 300, remDuplicated = TRUE)\r\n{\r\n  \r\n  N_big = N = nrow(xyDataFrame)\r\n  usePoints = rep(TRUE,N)\r\n  \r\n  if(N <= minMaxPoints[1]) # do nothing\r\n    return (usePoints)\r\n  \r\n  if(remDuplicated) # remove duplicated\r\n  {\r\n    usePoints = usePoints & (!duplicated(xyDataFrame))\r\n    N = sum(usePoints)\r\n  }\r\n  \r\n  if(N <= minMaxPoints[1]) # do nothing\r\n    return (usePoints)\r\n  \r\n  rangeX = range(xyDataFrame[,1])\r\n  rangeY = range(xyDataFrame[,2])\r\n  \r\n  gridX = seq(rangeX[1],rangeX[2], length.out = numXstrips + 1)\r\n  gridY = seq(rangeY[1],rangeY[2], length.out = numYstrips + 1)\r\n  \r\n  #go cell by cell and sparsify \r\n  for (iX in seq(1,numXstrips))\r\n  {\r\n    smallRangeX = c(gridX[iX],gridX[iX+1])\r\n    inStrip = xyDataFrame[,1]>= smallRangeX[1] & xyDataFrame[,1]<= smallRangeX[2] &  usePoints\r\n    if(sum(inStrip) > minmaxInStrip[1])\r\n      for (iY in seq(1,numYstrips))\r\n      {\r\n        smallRangeY = c(gridY[iY],gridY[iY+1])\r\n        inCell = xyDataFrame[,2]>= smallRangeY[1] & xyDataFrame[,2]<= smallRangeY[2] &  inStrip\r\n        if(sum(inCell) > maxInCell)\r\n        {\r\n          inCellIndexes = seq(1,N_big)[inCell]\r\n          #randomly select maxInCell out of inCellIndexes\r\n          iii = sample(inCellIndexes,size = sum(inCell) - maxInCell, replace = FALSE)\r\n          usePoints[iii] = FALSE\r\n        }\r\n      }\r\n    \r\n  }\r\n  N = sum(usePoints)\r\n  \r\n  #if by the end still too many points --> go on whole set  \r\n  if(N > minMaxPoints[2])\r\n  {\r\n    inIndexes = seq(1,N_big)[usePoints]\r\n    #randomly select minMaxPoints[2] out of inIndexes\r\n    iii = sample(inIndexes,size = minMaxPoints[2], replace = FALSE)\r\n    usePoints[-iii] = FALSE\r\n  }\r\n  return (usePoints)\r\n}\r\n\r\n# return FALSE if canvas is too small\r\ngoodPlotDimension = function(minWidthInch = 3,minHeightInch = 2.2)\r\n{\r\n  re = (par()$din[1] > minWidthInch) & (par()$din[2] > minHeightInch)\r\n  return(re)\r\n}\r\n\r\n#tweak the limits of the axis\r\nNiceLimitsAxis <- function(axisData, baseline =NULL, isPositive = TRUE)\r\n{\r\nlimsA = c(min(axisData), max(axisData)) # default\r\nif(is.null(baseline))\r\n  baseline = sum(limsA)/2\r\n\r\nlimsA = (limsA - mean(limsA))*1.3 + baseline # centralize\r\nlimsA[1] = min(limsA[1],min(axisData)) # include outliers\r\nlimsA[2] = max(limsA[2],max(axisData)) # include outliers\r\nif(limsA[1] < 0 && isPositive) # don't include region far away from 0\r\n{ \r\n  temp = -0.02 * (limsA[2])\r\n  limsA[1] = max(temp, limsA[1]) \r\n}\r\nreturn(limsA)\r\n}\r\n\r\n\r\n############# Input validation & initializations ############# \r\n\r\nif(conf2 < conf1)# swap\r\n{   temp = conf1; conf1 = conf2; conf2 = temp}\r\n\r\nvalidToPlot = TRUE\r\n\r\npbiWarning = \"\"\r\n\r\ngpd = goodPlotDimension()\r\n\r\nif(validToPlot && !gpd) # too small canvas\r\n{\r\n  validToPlot = FALSE\r\n  pbiWarning1 = \"Visual is \"\r\n  pbiWarning1 = cutStr2Show(pbiWarning1, strCex = sizeWarn/6, partAvailable = 0.9)\r\n  pbiWarning2 = \"too small \"\r\n  pbiWarning2 = cutStr2Show(pbiWarning2, strCex = sizeWarn/6, partAvailable = 0.9)\r\n  pbiWarning<-paste(pbiWarning1, \"<br>\", pbiWarning2, sep=\"\")\r\n  sizeWarn = 8 #smaller \r\n}\r\n\r\nif(validToPlot && (ncol(dataset)< 2)) # invalid input \r\n{\r\n  validToPlot = FALSE\r\n  pbiWarning1 = \"Both population and occurrence are required\"\r\n  pbiWarning = cutStr2Show(pbiWarning1, strCex = sizeWarn/6, partAvailable = 0.9)\r\n}\r\n\r\nif(validToPlot)\r\n  validData = complete.cases(dataset) & (dataset[,1]>=dataset[,2])\r\n\r\nif(validToPlot && (sum(validData) < minPoints)) # not enough data samples\r\n{\r\n  validToPlot = FALSE\r\n  pbiWarning1 = \"Not enough VALID data samples\"\r\n  pbiWarning1 = cutStr2Show(pbiWarning1, strCex = sizeWarn/6, partAvailable = 0.9)\r\n  pbiWarning2 = \"for funnel plot\"\r\n  pbiWarning2 = cutStr2Show(pbiWarning2, strCex = sizeWarn/6, partAvailable = 0.9)\r\n  pbiWarning<-paste(pbiWarning1, \"\\n\", pbiWarning2, sep=\"\")\r\n}\r\n\r\n\r\n############# Main code #####################\r\n\r\nif(validToPlot)\r\n{\r\n\r\n  dataset = dataset[validData,]# keep only valid\r\n  namesDS = names(dataset)\r\n  \r\n  countValue = dataset[,1]\r\n  p = dataset[,2]/dataset[,1]\r\n  p.se <- sqrt((p*(1-p)) / (countValue))\r\n  df <- data.frame(p, countValue, p.se)\r\n  \r\n  ## common effect (fixed effect model)\r\n  p.fem <- weighted.mean(p[p.se>0], 1/p.se[p.se>0]^2)\r\n  \r\n  ## lower and upper limits, based on FEM estimator\r\n  zLow = qnorm(conf1)\r\n  zUp = qnorm(conf2)\r\n  \r\n  if(axisXisPercentage)\r\n  {\r\n    mult = 100\r\n    entryWordLabelY = \"Percentage of \"\r\n  }\r\n  else\r\n  {\r\n    mult = 1\r\n    entryWordLabelY = \"Ratio of \"\r\n  }\r\n  \r\n  number.seq <- seq(min(countValue), max(countValue), 1000)\r\n  number.llconf1 <- (p.fem - zLow * sqrt((p.fem*(1-p.fem)) / (number.seq)))*mult\r\n  number.ulconf1 <- (p.fem + zLow * sqrt((p.fem*(1-p.fem)) / (number.seq)))*mult\r\n  number.llconf2 <- (p.fem - zUp * sqrt((p.fem*(1-p.fem)) / (number.seq)))*mult\r\n  number.ulconf2 <- (p.fem + zUp * sqrt((p.fem*(1-p.fem)) / (number.seq)))*mult\r\n  \r\n  yAxis = p*mult\r\n  p.fem = p.fem*mult\r\n  \r\n  dfCI <- data.frame(number.llconf1, number.ulconf1, number.llconf2, number.ulconf2, number.seq, p.fem)\r\n  \r\n  #tweak the limits of the y-axis\r\n  limsY = NiceLimitsAxis(axisData = yAxis, baseline = p.fem)\r\n  \r\n  xLabText = cutStr2Show( namesDS[1], strCex = sizeLabel/6, isH = TRUE, partAvailable = 0.85)\r\n  yLabText = cutStr2Show( paste(entryWordLabelY, namesDS[2], sep =\"\"), strCex = sizeLabel/6, isH = FALSE, partAvailable = 0.85)\r\n  \r\n  ## draw plot\r\n  if(sparsify)\r\n    drawPoints = SparsifyScatter(dataset)# remove points from dense regions\r\n  else\r\n    drawPoints = SparsifyScatter(dataset,minMaxPoints = c(Inf,Inf))\r\n  \r\n  fp <- ggplot(aes(x = countValue[drawPoints], y = yAxis[drawPoints]), data = df[drawPoints,]) \r\n  fp <- fp + geom_point(shape = 19, colour = alpha(pointsCol,transparency), size = pointCex*2 ) \r\n  \r\n  fp <- fp + geom_line(aes(x = number.seq, y = number.llconf1),linetype = 1, colour = \"green\",data = dfCI) \r\n  fp <- fp + geom_line(aes(x = number.seq, y = number.ulconf1),linetype = 1, colour = \"green\", data = dfCI) \r\n  \r\n  fp <- fp + geom_line(aes(x = number.seq, y = number.llconf2),linetype = 2, colour = \"red\",data = dfCI) \r\n  fp <- fp + geom_line(aes(x = number.seq, y = number.ulconf2), linetype = 2, colour = \"red\",data = dfCI) \r\n  \r\n  fp <- fp + geom_hline(aes(yintercept = p.fem), data = dfCI, colour = lineColor, linetype = 4)\r\n  \r\n  if(scaleYformat %in% c(\"none\"))\r\n    fp <- fp + scale_y_continuous(limits =limsY)\r\n  \r\n  if(scaleYformat %in% c(\"comma\"))\r\n    fp <- fp + scale_y_continuous(limits =limsY, labels = comma)\r\n  \r\n  if(scaleYformat %in% c(\"scientific\"))\r\n    fp <- fp + scale_y_continuous(limits =limsY, labels = scientific)\r\n  \r\n  if(scaleXformat %in% c(\"comma\"))\r\n    fp <- fp + scale_x_continuous(labels = comma)\r\n  \r\n  if(scaleXformat %in% c(\"dollar\"))\r\n    fp <- fp + scale_x_continuous(labels = dollar)\r\n  \r\n  if(scaleXformat %in% c(\"scientific\"))\r\n    fp <- fp + scale_x_continuous(labels = scientific)\r\n  \r\n  fp <- fp + xlab(xLabText) + ylab(yLabText) + theme_bw()\r\n  \r\n  if(verticalPlot)\r\n    fp <- fp +  coord_flip()\r\n  \r\n}else{# empty plot \r\n  fp <- ggplot()\r\n}\r\n\r\n#add warning as title\r\nfp = fp + labs (title = pbiWarning, caption = NULL) + theme_bw() + \r\n  theme(plot.title  = element_text(hjust = 0.5, size = sizeWarn), \r\n        axis.title=element_text(size =  sizeLabel, colour = colLabel),\r\n        axis.text=element_text(size =  sizeTicks),\r\n        panel.border = element_blank(), axis.line = element_line())\r\n\r\nif(!validToPlot) # remove axes from empty plot \r\n  fp = fp + theme(axis.line = element_blank())\r\n\r\nprint(fp)\r\n"}}}],"objects":{"rcv_script":{"properties":{"provider":{"type":{"text":true}},"source":{"type":{"scripting":{"source":true}}}}}},"suppressDefaultTitle":true,"privileges":[]},"dependencies":{"cranPackages":[{"name":"ggplot2","displayName":"GG Plot 2","url":"https://cran.r-project.org/web/packages/ggplot2/index.html"},{"name":"scales","displayName":"scales: Scale Functions for Visualization","url":"https://cran.r-project.org/web/packages/scales/index.html"}]},"content":{"js":"var funnelVisual707C8B5B902E4671972B2C3CC511329F;(()=>{\"use strict\";var e={50:(e,i,t)=>{t.d(i,{E:()=>r});var a=t(706),s=a.Zb,l=a.Hn;class n extends s{constructor(){super(...arguments),this.provider=void 0,this.source=void 0,this.name=\"rcv_script\",this.displayName=\"rcv_script\",this.slices=[this.provider,this.source]}}class r extends l{constructor(){super(...arguments),this.rcvScriptCard=new n,this.cards=[this.rcvScriptCard]}}},728:(e,i,t)=>{t.d(i,{u:()=>l});var a=t(261),s=t(50);class l{constructor(e){this.formattingSettingsService=new a.Z,this.imageDiv=document.createElement(\"div\"),this.imageDiv.className=\"rcv_autoScaleImageContainer\",this.imageElement=document.createElement(\"img\"),this.imageElement.className=\"rcv_autoScaleImage\",this.imageDiv.appendChild(this.imageElement),e.element.appendChild(this.imageDiv)}update(e){if(!(e&&e.type&&e.viewport&&e.dataViews&&0!==e.dataViews.length&&e.dataViews[0]))return;const i=e.dataViews[0];this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(s.E,e.dataViews);let t=null;i.scriptResult&&i.scriptResult.payloadBase64&&(t=\"data:image/png;base64,\"+i.scriptResult.payloadBase64),this.imageElement.src=t||null,this.onResizing(e.viewport)}onResizing(e){this.imageDiv.style.height=e.height+\"px\",this.imageDiv.style.width=e.width+\"px\"}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}},706:(e,i,t)=>{t.d(i,{Hn:()=>s,Zb:()=>l});class a{}class s{}class l extends a{getFormattingCard(e,i,t){return{displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,groups:[i],uid:e,analyticsPane:this.analyticsPane}}}},261:(e,i,t)=>{t.d(i,{Z:()=>a});const a=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,i){var t,a,s;let l=new e,n=null===(a=null===(t=null==i?void 0:i[0])||void 0===t?void 0:t.metadata)||void 0===a?void 0:a.objects;return n&&(null===(s=l.cards)||void 0===s||s.forEach((e=>{var i,t,a;null===(i=null==e?void 0:e.slices)||void 0===i||i.forEach((i=>{null==i||i.setPropertiesValues(n,e.name)})),null===(a=null===(t=null==e?void 0:e.container)||void 0===t?void 0:t.containerItems)||void 0===a||a.forEach((i=>{var t;null===(t=null==i?void 0:i.slices)||void 0===t||t.forEach((i=>{null==i||i.setPropertiesValues(n,e.name)}))}))}))),l}buildFormattingModel(e){var i;let t={cards:[]};return null===(i=e.cards)||void 0===i||i.forEach((e=>{if(!e)return;const i=e.name,a=e.name+\"-group\";let s={displayName:void 0,slices:[],uid:a},l=e.getFormattingCard(i,s,this.localizationManager);t.cards.push(l);const n={};if(e.container){const t=e.container,r=a+\"-container\",o={displayName:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,description:this.localizationManager&&t.descriptionKey?this.localizationManager.getDisplayName(t.descriptionKey):t.description,containerItems:[],uid:r};t.containerItems.forEach((e=>{const t=e.displayNameKey?e.displayNameKey:e.displayName,a=r+t;let s={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:a};this.buildFormattingSlices(e.slices,i,n,l,s.slices),o.containerItems.push(s)})),s.container=o}e.slices&&this.buildFormattingSlices(e.slices,i,n,l,s.slices),l.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e)})),t}buildFormattingSlices(e,i,t,a,s){null==e||e.forEach((e=>{let l=null==e?void 0:e.getFormattingSlice(i,this.localizationManager);l&&(void 0===t[e.name]?t[e.name]=0:(t[e.name]++,l.uid=`${l.uid}-${t[e.name]}`),e.topLevelToggle?(l.suppressDisplayName=!0,a.topLevelToggle=l):s.push(l))}))}getRevertToDefaultDescriptor(e){var i,t;const a={};let s=[],l=this.getSlicesRevertToDefaultDescriptor(e.name,e.slices,a),n=[];return null===(t=null===(i=e.container)||void 0===i?void 0:i.containerItems)||void 0===t||t.forEach((i=>{n=n.concat(this.getSlicesRevertToDefaultDescriptor(e.name,i.slices,a))})),s=l.concat(n),s}getSlicesRevertToDefaultDescriptor(e,i,t){let a=[];return null==i||i.forEach((i=>{i&&!t[i.name]&&(t[i.name]=!0,a=a.concat(i.getRevertToDefaultDescriptor(e)))})),a}}},738:e=>{e.exports=Function(\"return this\")()}},i={};function t(a){var s=i[a];if(void 0!==s)return s.exports;var l=i[a]={exports:{}};return e[a](l,l.exports,t),l.exports}t.d=(e,i)=>{for(var a in i)t.o(i,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:i[a]})},t.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),t.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var a={};(()=>{t.r(a),t.d(a,{default:()=>l});var e=t(728),i=t(738).powerbi,s={name:\"funnelVisual707C8B5B902E4671972B2C3CC511329F\",displayName:\"funnelVisual\",class:\"Visual\",apiVersion:\"5.1.0\",create:i=>{if(e.u)return new e.u(i);throw\"Visual instance not found\"},createModalDialog:(e,i,t)=>{const a=globalThis.dialogRegistry;e in a&&new a[e](i,t)},custom:!0};void 0!==i&&(i.visuals=i.visuals||{},i.visuals.plugins=i.visuals.plugins||{},i.visuals.plugins.funnelVisual707C8B5B902E4671972B2C3CC511329F=s);const l=s})(),funnelVisual707C8B5B902E4671972B2C3CC511329F=a})();","css":"","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":"","toolsVersion":null}